FROM node:18
WORKDIR /app
# Copy backend package files
COPY server/package.json server/package-lock.json ./
# Copy Prisma schema and migrations from root
COPY prisma/ ./prisma/
RUN npm install
RUN npx prisma generate
RUN npx prisma migrate deploy  # Apply migrations
# Copy remaining backend files
COPY server/ .
EXPOSE 3000
CMD ["npm", "run", "dev"]